<!-- story-detail.component.html -->
<div class="story-detail-container">

  <!-- Carte centrale de l'histoire -->
  <div class="story-card">
    
    <!-- Header TETRIS avec zones cliquables s√©par√©es -->
    <div class="card-header">
      <div class="author-avatar" (click)="goToAuthorProfile()" [style.background-image]="story().user?.avatar ? 'url(http://localhost:3000' + story().user?.avatar + ')' : ''">
        <span class="avatar-placeholder" *ngIf="!story().user?.avatar">üë§</span>
      </div>
      
      <div class="author-content">
        <div class="author-top-line">
          <span class="author-name" (click)="goToAuthorProfile()">{{ story().user?.username || 'Auteur Inconnu' }}</span>
          
          <div class="header-like-section">
            @if (showConnectionRequired()) {
              <div class="connection-banner">
                <span>Connexion requise</span>
              </div>
            } @else {
              <div class="like-display">
                <button class="like-btn" (click)="toggleLike()" [disabled]="isOwnStory()">
                  <span class="heart-icon" [class.liked]="isLiked()">
                    {{ isLiked() ? '‚ô•' : '‚ô°' }}
                  </span>
                </button>
                <span class="likes-count">{{ getLikesCount() }}</span>
              </div>
            }
          </div>
        </div>
        
        <div class="author-description">{{ story().user?.description || '√âcrivain martien' }}</div>
      </div>
    </div>

    <!-- S√©parateur -->
    <div class="card-separator"></div>

    <!-- Titre et date -->
    <div class="title-section">
      <div class="title-wrapper">
        <h1>{{ story().title }}</h1>
      </div>
      <div class="date-wrapper">
        <p>{{ getFormattedDate() }}</p>
      </div>
    </div>

    <!-- Contenu de l'histoire -->
    <div class="content-section">
      <div class="story-text">{{ story().content }}</div>
    </div>

    <!-- S√©parateur -->
    <div class="card-separator"></div>

    <!-- Footer avec navigation -->
    <div class="card-footer">
      <button class="nav-btn prev-btn" 
              [disabled]="!hasPreviousStory()" 
              (click)="goToPreviousStory()"
              [class.hidden]="!hasPreviousStory()">
        <span class="nav-arrow">‚Üê</span>
        <span class="nav-text">Histoire pr√©c√©dente</span>
      </button>
      
      <button class="nav-btn next-btn" 
              [disabled]="!hasNextStory()" 
              (click)="goToNextStory()"
              [class.hidden]="!hasNextStory()">
        <span class="nav-text">Histoire suivante</span>
        <span class="nav-arrow">‚Üí</span>
      </button>
    </div>

  </div>

  <!-- √âtats de chargement et d'erreur -->
  <div class="loading-state" *ngIf="loading()">
    <div class="loading-spinner"></div>
    <p>Chargement de l'histoire...</p>
  </div>

  <div class="error-state" *ngIf="error()">
    <div class="error-icon">‚ö†Ô∏è</div>
    <p>{{ error() }}</p>
    <button class="retry-btn" (click)="loadStory()">
      R√©essayer
    </button>
  </div>

</div>